<?xml version="1.0" encoding="UTF-8"?>
<svg viewBox="0 0 800 700" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="800" height="700" fill="#f8f9fa" rx="10" ry="10"/>
  
  <!-- Title -->
  <text x="400" y="40" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="#333">SVMClassifier 算法结构图</text>
  
  <!-- Legend - Horizontal layout -->
  <rect x="50" y="70" width="16" height="16" fill="#6ab7ff" stroke="#0066cc" stroke-width="2"/>
  <text x="70" y="83" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="start">输入处理</text>
  
  <rect x="150" y="70" width="16" height="16" fill="#ffd700" stroke="#cc9900" stroke-width="2"/>
  <text x="170" y="83" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="start">SVM算法核心</text>
  
  <rect x="270" y="70" width="16" height="16" fill="#90ee90" stroke="#006400" stroke-width="2"/>
  <text x="290" y="83" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="start">训练与调优</text>
  
  <rect x="390" y="70" width="16" height="16" fill="#d8bfd8" stroke="#8a2be2" stroke-width="2"/>
  <text x="410" y="83" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="start">预测输出</text>
  
  <rect x="510" y="70" width="16" height="16" fill="#ff9999" stroke="#cc0000" stroke-width="2"/>
  <text x="530" y="83" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="start">PyTorch兼容</text>
  
  <rect x="630" y="70" width="16" height="16" fill="#e6e6e6" stroke="#666666" stroke-width="2"/>
  <text x="650" y="83" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="start">持久化</text>
  
  <!-- Input Processing Block -->
  <rect x="50" y="110" width="200" height="120" rx="8" ry="8" fill="#6ab7ff" stroke="#0066cc" stroke-width="2"/>
  <text x="150" y="130" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">输入处理</text>
  
  <rect x="70" y="150" width="160" height="60" rx="5" ry="5" fill="#e6e6e6" stroke="#666666" stroke-width="1"/>
  <text x="150" y="170" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">__preprocess_data()</text>
  <text x="150" y="190" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">- PyTorch张量 → NumPy</text>
  <text x="150" y="205" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">- 原始信号展平</text>

  <!-- SVM Algorithm Core (Expanded) -->
  <rect x="300" y="110" width="500" height="370" rx="8" ry="8" fill="#ffd700" stroke="#cc9900" stroke-width="2"/>
  <text x="550" y="130" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">SVM算法核心</text>
  
  <!-- Mathematical Foundation -->
  <rect x="320" y="150" width="460" height="90" rx="5" ry="5" fill="#fff" stroke="#888" stroke-width="1"/>
  <text x="550" y="170" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">数学基础</text>
  <text x="550" y="190" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">目标: 寻找最大间隔超平面 w·x + b = 0 分离数据</text>
  <text x="550" y="210" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">优化问题: min(1/2‖w‖²) subject to y₍ᵢ₎(w·x₍ᵢ₎ + b) ≥ 1</text>
  <text x="550" y="230" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">对偶形式: max Σα₍ᵢ₎ - (1/2)ΣΣα₍ᵢ₎α₍ⱼ₎y₍ᵢ₎y₍ⱼ₎K(x₍ᵢ₎,x₍ⱼ₎)</text>
  
  <!-- Kernel Tricks -->
  <rect x="320" y="250" width="220" height="100" rx="5" ry="5" fill="#fff" stroke="#888" stroke-width="1"/>
  <text x="430" y="270" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">核函数 K(x,y)</text>
  <text x="430" y="290" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">线性核: K(x,y) = x·y</text>
  <text x="430" y="310" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">RBF核: K(x,y) = exp(-γ‖x-y‖²)</text>
  <text x="430" y="330" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">多项式核: K(x,y) = (γx·y + r)ᵈ</text>
  
  <!-- Hyperparameters -->
  <rect x="560" y="250" width="220" height="100" rx="5" ry="5" fill="#fff" stroke="#888" stroke-width="1"/>
  <text x="670" y="270" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">超参数</text>
  <text x="670" y="290" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">C: 正则化参数 (错误容忍度)</text>
  <text x="670" y="310" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">γ (gamma): 核函数参数</text>
  <text x="670" y="330" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">class_weight: 处理类别不平衡</text>
  
  <!-- Implementation Details -->
  <rect x="320" y="360" width="220" height="100" rx="5" ry="5" fill="#fff" stroke="#888" stroke-width="1"/>
  <text x="430" y="380" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">实现细节</text>
  <text x="430" y="400" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">sklearn.svm.SVC</text>
  <text x="430" y="420" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">SMO算法求解优化问题</text>
  <text x="430" y="440" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">缓存优化加速训练</text>
  
  <!-- Decision Function -->
  <rect x="560" y="360" width="220" height="100" rx="5" ry="5" fill="#fff" stroke="#888" stroke-width="1"/>
  <text x="670" y="380" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">决策函数</text>
  <text x="670" y="400" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">f(x) = Σ(α₍ᵢ₎y₍ᵢ₎K(x₍ᵢ₎,x) + b)</text>
  <text x="670" y="420" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">支持向量: 仅决策边界上的点</text>
  <text x="670" y="440" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">输出: 样本到决策边界的距离</text>
  
  <!-- Training Block -->
  <rect x="50" y="250" width="200" height="130" rx="8" ry="8" fill="#90ee90" stroke="#006400" stroke-width="2"/>
  <text x="150" y="270" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">训练与调优</text>
  
  <rect x="70" y="290" width="160" height="35" rx="5" ry="5" fill="#e6e6e6" stroke="#666666" stroke-width="1"/>
  <text x="150" y="312" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">fit(train_loader, val_loader)</text>
  
  <rect x="70" y="330" width="160" height="35" rx="5" ry="5" fill="#e6e6e6" stroke="#666666" stroke-width="1"/>
  <text x="150" y="352" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">grid_search(param_grid)</text>
  
  <!-- Prediction Block -->
  <rect x="50" y="400" width="200" height="80" rx="8" ry="8" fill="#d8bfd8" stroke="#8a2be2" stroke-width="2"/>
  <text x="150" y="420" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">预测输出</text>
  
  <rect x="70" y="440" width="160" height="30" rx="5" ry="5" fill="#e6e6e6" stroke="#666666" stroke-width="1"/>
  <text x="150" y="460" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">forward(x) → logits, dummy_attention</text>
  
  <!-- PyTorch Compatibility -->
  <rect x="50" y="500" width="200" height="170" rx="8" ry="8" fill="#ff9999" stroke="#cc0000" stroke-width="2"/>
  <text x="150" y="520" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">PyTorch兼容层</text>
  
  <rect x="70" y="540" width="160" height="110" rx="5" ry="5" fill="#e6e6e6" stroke="#666666" stroke-width="1"/>
  <text x="150" y="560" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">to(device)</text>
  <text x="150" y="580" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">eval() / train()</text>
  <text x="150" y="600" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">parameters()</text>
  <text x="150" y="620" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">get_latent(x)</text>
  <text x="150" y="640" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">兼容神经网络模型接口</text>
  
  <!-- Model Persistence -->
  <rect x="300" y="500" width="500" height="80" rx="8" ry="8" fill="#e6e6e6" stroke="#666666" stroke-width="2"/>
  <text x="550" y="520" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">模型持久化</text>
  
  <rect x="320" y="540" width="220" height="30" rx="5" ry="5" fill="#add8e6" stroke="#4682b4" stroke-width="1"/>
  <text x="430" y="560" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">save(filepath) → joblib.dump()</text>
  
  <rect x="560" y="540" width="220" height="30" rx="5" ry="5" fill="#add8e6" stroke="#4682b4" stroke-width="1"/>
  <text x="670" y="560" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">load(filepath) → joblib.load()</text>
  
  <!-- Model Features -->
  <rect x="300" y="600" width="500" height="100" rx="8" ry="8" fill="#f0f0f0" stroke="#888" stroke-width="2"/>
  <text x="550" y="620" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">SVM模型特性</text>
  
  <text x="320" y="640" font-family="Arial, sans-serif" font-size="12" fill="#333">• 数据处理: 原始信号自动展平/(batch,seq,chan)→(batch,seq*chan)</text>
  <text x="320" y="660" font-family="Arial, sans-serif" font-size="12" fill="#333">• 算法优势: 小样本学习、统计保证、避免过拟合、训练速度快</text>
  <text x="320" y="680" font-family="Arial, sans-serif" font-size="12" fill="#333">• 输出适配: 决策函数值→logits、虚拟注意力权重→接口一致性</text>
  
  <!-- Connections -->
  <!-- Input to SVM -->
  <line x1="250" y1="170" x2="300" y2="170" stroke="#666" stroke-width="2"/>
  <polygon points="295,165 300,175 305,165" fill="#666"/>
  
  <!-- Training to SVM -->
  <line x1="250" y1="310" x2="300" y2="310" stroke="#666" stroke-width="2"/>
  <polygon points="295,305 300,315 305,305" fill="#666"/>
  
  <!-- SVM to Prediction -->
  <line x1="300" y1="440" x2="250" y2="440" stroke="#666" stroke-width="2"/>
  <polygon points="245,435 250,445 255,435" fill="#666"/>
  
  <!-- Prediction to Compatibility -->
  <line x1="150" y1="480" x2="150" y2="500" stroke="#666" stroke-width="2"/>
  <polygon points="145,495 150,505 155,495" fill="#666"/>
  
  <!-- SVM to Persistence -->
  <line x1="550" y1="480" x2="550" y2="500" stroke="#666" stroke-width="2"/>
  <polygon points="545,495 550,505 555,495" fill="#666"/>
</svg>