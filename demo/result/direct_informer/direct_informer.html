<?xml version="1.0" encoding="UTF-8"?>
<svg viewBox="0 0 800 650" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="800" height="650" fill="#f8f9fa" rx="10" ry="10"/>
  
  <!-- Title -->
  <text x="400" y="40" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="#333">DirectInformerClassifier 模型结构图</text>
  
  <!-- Legend - Horizontal layout -->
  <rect x="50" y="70" width="16" height="16" fill="#6ab7ff" stroke="#0066cc" stroke-width="2"/>
  <text x="70" y="83" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="start">输入层</text>
  
  <rect x="150" y="70" width="16" height="16" fill="#f0e68c" stroke="#daa520" stroke-width="2"/>
  <text x="170" y="83" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="start">投影层</text>
  
  <rect x="250" y="70" width="16" height="16" fill="#a0a0ff" stroke="#0000ff" stroke-width="2"/>
  <text x="270" y="83" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="start">Informer编码器</text>
  
  <rect x="370" y="70" width="16" height="16" fill="#ffa07a" stroke="#ff4500" stroke-width="2"/>
  <text x="390" y="83" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="start">全局注意力池化</text>
  
  <rect x="490" y="70" width="16" height="16" fill="#d8bfd8" stroke="#8a2be2" stroke-width="2"/>
  <text x="510" y="83" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="start">全连接层</text>
  
  <rect x="590" y="70" width="16" height="16" fill="#ff9999" stroke="#cc0000" stroke-width="2"/>
  <text x="610" y="83" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="start">输出层</text>
  
  <rect x="680" y="70" width="16" height="16" fill="#add8e6" stroke="#4682b4" stroke-width="2"/>
  <text x="700" y="83" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="start">激活函数</text>
  
  <!-- Input Layer -->
  <rect x="150" y="120" width="180" height="60" rx="8" ry="8" fill="#6ab7ff" stroke="#0066cc" stroke-width="2"/>
  <text x="240" y="150" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">输入层</text>
  <text x="240" y="170" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">(batch_size, seq_length, input_channels)</text>
  
  <!-- Input Projection -->
  <rect x="150" y="200" width="180" height="40" rx="8" ry="8" fill="#f0e68c" stroke="#daa520" stroke-width="2"/>
  <text x="240" y="225" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">Linear(input_channels, d_model)</text>
  
  <!-- Informer Encoder -->
  <rect x="150" y="260" width="180" height="200" rx="8" ry="8" fill="#a0a0ff" stroke="#0000ff" stroke-width="2"/>
  <text x="240" y="285" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">Informer编码器</text>
  <text x="240" y="310" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">位置编码</text>
  <text x="240" y="335" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">Dropout + LayerNorm</text>
  <text x="240" y="365" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">多层编码器 (depth 层)</text>
  <rect x="170" y="380" width="140" height="60" rx="5" ry="5" fill="#b0c4de" stroke="#4682b4" stroke-width="1"/>
  <text x="240" y="400" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">概率稀疏自注意力</text>
  <text x="240" y="420" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">前馈神经网络</text>
  <text x="240" y="440" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">Layer Normalization</text>
  
  <!-- Global Attention Pooling -->
  <rect x="450" y="120" width="180" height="80" rx="8" ry="8" fill="#ffa07a" stroke="#ff4500" stroke-width="2"/>
  <text x="540" y="145" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">全局注意力池化</text>
  <text x="540" y="170" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">Linear(d_model, 1)</text>
  <text x="540" y="190" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">Softmax(dim=1)</text>
  
  <!-- Context Vector -->
  <rect x="450" y="220" width="180" height="40" rx="8" ry="8" fill="#e6e6e6" stroke="#666666" stroke-width="2"/>
  <text x="540" y="245" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">上下文向量 (batch_size, d_model)</text>
  
  <!-- FC Layers -->
  <rect x="450" y="280" width="180" height="30" rx="8" ry="8" fill="#d8bfd8" stroke="#8a2be2" stroke-width="2"/>
  <text x="540" y="300" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">Linear(d_model, 128)</text>
  
  <rect x="450" y="320" width="180" height="30" rx="8" ry="8" fill="#add8e6" stroke="#4682b4" stroke-width="2"/>
  <text x="540" y="340" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">ReLU</text>
  
  <rect x="450" y="360" width="180" height="30" rx="8" ry="8" fill="#e6e6e6" stroke="#666666" stroke-width="2"/>
  <text x="540" y="380" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">Dropout(dropout_rate)</text>
  
  <rect x="450" y="400" width="180" height="30" rx="8" ry="8" fill="#d8bfd8" stroke="#8a2be2" stroke-width="2"/>
  <text x="540" y="420" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">Linear(128, 64)</text>
  
  <rect x="450" y="440" width="180" height="30" rx="8" ry="8" fill="#add8e6" stroke="#4682b4" stroke-width="2"/>
  <text x="540" y="460" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">ReLU</text>
  
  <!-- Output Layer -->
  <rect x="450" y="480" width="180" height="40" rx="8" ry="8" fill="#ff9999" stroke="#cc0000" stroke-width="2"/>
  <text x="540" y="500" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">输出层</text>
  <text x="540" y="515" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">Linear(64, num_classes)</text>
  
  <!-- Connections -->
  <!-- Input to Projection -->
  <line x1="240" y1="180" x2="240" y2="200" stroke="#666" stroke-width="2"/>
  <polygon points="235,195 240,205 245,195" fill="#666"/>
  
  <!-- Projection to Informer -->
  <line x1="240" y1="240" x2="240" y2="260" stroke="#666" stroke-width="2"/>
  <polygon points="235,255 240,265 245,255" fill="#666"/>
  
  <!-- Informer to Global Attention -->
  <line x1="330" y1="360" x2="380" y2="360" stroke="#666" stroke-width="2"/>
  <line x1="380" y1="360" x2="380" y2="160" stroke="#666" stroke-width="2"/>
  <line x1="380" y1="160" x2="450" y2="160" stroke="#666" stroke-width="2"/>
  <polygon points="445,155 450,165 455,155" fill="#666"/>
  
  <!-- Global Attention to Context Vector -->
  <line x1="540" y1="200" x2="540" y2="220" stroke="#666" stroke-width="2"/>
  <polygon points="535,215 540,225 545,215" fill="#666"/>
  
  <!-- Context Vector to FC1 -->
  <line x1="540" y1="260" x2="540" y2="280" stroke="#666" stroke-width="2"/>
  <polygon points="535,275 540,285 545,275" fill="#666"/>
  
  <!-- FC1 to ReLU -->
  <line x1="540" y1="310" x2="540" y2="320" stroke="#666" stroke-width="2"/>
  <polygon points="535,315 540,325 545,315" fill="#666"/>
  
  <!-- ReLU to Dropout -->
  <line x1="540" y1="350" x2="540" y2="360" stroke="#666" stroke-width="2"/>
  <polygon points="535,355 540,365 545,355" fill="#666"/>
  
  <!-- Dropout to FC2 -->
  <line x1="540" y1="390" x2="540" y2="400" stroke="#666" stroke-width="2"/>
  <polygon points="535,395 540,405 545,395" fill="#666"/>
  
  <!-- FC2 to ReLU -->
  <line x1="540" y1="430" x2="540" y2="440" stroke="#666" stroke-width="2"/>
  <polygon points="535,435 540,445 545,435" fill="#666"/>
  
  <!-- ReLU to Output -->
  <line x1="540" y1="470" x2="540" y2="480" stroke="#666" stroke-width="2"/>
  <polygon points="535,475 540,485 545,475" fill="#666"/>
  
  <!-- Attention Weights Output -->
  <path d="M 630 160 C 680 160, 680 260, 680 550" stroke="#ff4500" stroke-width="2" stroke-dasharray="5,5" fill="none"/>
  <text x="700" y="350" font-family="Arial, sans-serif" font-size="12" fill="#ff4500" text-anchor="middle" transform="rotate(90, 700, 350)">注意力权重输出</text>
  
  <!-- Informer Architecture Detail Box -->
  <rect x="150" y="540" width="500" height="90" rx="8" ry="8" fill="#f0f0f0" stroke="#888" stroke-width="2"/>
  <text x="170" y="565" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#333">Informer模型特点:</text>
  <text x="170" y="590" font-family="Arial, sans-serif" font-size="14" fill="#333">• 使用概率稀疏自注意力机制 (ProbSparse Self-Attention)</text>
  <text x="170" y="615" font-family="Arial, sans-serif" font-size="14" fill="#333">• 直接处理原始振动信号，不需要CNN进行特征提取</text>